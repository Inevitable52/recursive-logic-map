<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Percy Recursive Logic Map</title>

<link rel="stylesheet" href="style.css?v=6.4" />
</head>
<body>

<header style="text-align:center; padding:10px;">
  <h1>Percy Recursive Logic Map</h1>
  <p>Visualizing Logic Seeds G080‚ÄìG800</p>
</header>

<main>
  <!-- Search Input -->
  <input type="text" id="seed-search" placeholder="Search G-seed..." autocomplete="off"/>

  <!-- Zoom Controls -->
  <div class="zoom-controls">
    <button onclick="zoomLevel *= 1.2; applyTransform();">Zoom In</button>
    <button onclick="zoomLevel *= 0.8; applyTransform();">Zoom Out</button>
  </div>

  <!-- Logic Map -->
  <div id="logic-map">
    <svg width="100%" height="100%"></svg>
    <div id="logic-nodes"></div>
  </div>

  <!-- Voice Visualizer -->
  <div id="voice-box">
    <div id="voice-bars">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <div id="voice-wave"></div>
  </div>

  <!-- Message & Console -->
  <div id="percy-message">Click a logic node to hear Percy‚Äôs thoughts...</div>
  <div id="percy-console">
    <p class="console-line">Percy initialized. Click a node.</p>
  </div>
</main>

<!-- Ask Percy Input -->
<div id="percy-ask" style="position:fixed; bottom:20px; left:50%; transform:translateX(-50%); z-index:1000; display:flex; gap:4px;">
  <input type="text" id="ask-input" placeholder="Ask Percy..." autocomplete="off" />
  <button id="ask-btn">Ask</button>
</div>

<footer style="text-align:center;padding:8px;margin-top:10px;">
  <p>¬© 2025 Fabian V Omega ‚Äî Percy Recursive Logic System</p>
</footer>

<!-- Percy Script -->
<script src="js/percy.js?v=6.4"></script>
<script>
  window.Percy = { percyRespond };

  // Seed Search
  const searchInput = document.getElementById('seed-search');
  searchInput.addEventListener('input', () => {
    const val = searchInput.value.trim().toUpperCase();
    document.querySelectorAll('.node').forEach(n=>{
      n.style.display = (!val || n.textContent.toUpperCase().includes(val)) ? 'flex' : 'none';
    });
  });

  // Ask Percy
  const askInput = document.getElementById('ask-input');
  const askBtn = document.getElementById('ask-btn');
  askBtn.addEventListener('click', () => {
    if(askInput.value.trim()) {
      Percy.percyRespond('User', {message: askInput.value});
      askInput.value='';
    }
  });
  askInput.addEventListener('keydown', e => { if(e.key==='Enter') askBtn.click(); });
</script>

<!-- Percy Self-Mod (Memory-Based) -->
<script>
(function PercyPartC(){
  if(!window.PercyState) return console.warn("‚ùå PercyState not loaded yet.");
  PercyState.memoryRewrite = function(changeFn){
    try {
      changeFn(this);
      Memory.save("gnodes", this.gnodes);
      if(typeof refreshNodes==='function') refreshNodes();
      if(typeof UI!=='undefined' && UI.say) UI.say("‚úÖ Percy memory-based self-mod applied");
    } catch(e){
      console.error("‚ùå Percy memoryRewrite error:", e);
      if(typeof UI!=='undefined' && UI.say) UI.say(`‚ùå Percy memoryRewrite error: ${e.message}`);
    }
  };
  PercyState.memoryRewrite(ps => { ps.createSeed("üß© Test self-mod applied: Percy now can memory-mod itself!", "thought"); });
  window.PercyMemoryMod = (codeStr) => { try { PercyState.memoryRewrite(ps => eval(codeStr)); } catch(e){ if(typeof UI!=='undefined' && UI.say) UI.say(`‚ùå Interactive memory mod error: ${e.message}`); } };
  if(typeof UI!=='undefined' && UI.say) UI.say("üß© Percy Part C (self-mod + interactive) loaded.");
})();
</script>

</body>
</html>
